---
import { loadContent } from '../utils/content';
const { frontmatter, html } = loadContent('about.md');

function withBase(assetPath: string) {
  const base = import.meta.env.BASE_URL.endsWith('/') ? import.meta.env.BASE_URL : `${import.meta.env.BASE_URL}/`;
  const clean = assetPath.startsWith('/') ? assetPath.slice(1) : assetPath;
  return `${base}${clean}`;
}

const aboutImageSrc = withBase(frontmatter.image as string);

const stats = [
  {
    icon: `<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>`,
    label: frontmatter.experience,
  },
  {
    icon: `<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0z" /></svg>`,
    label: frontmatter.clients,
  },
  {
    icon: `<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>`,
    label: frontmatter.method,
  },
];
---

<section id="about" class="py-12 sm:py-24 px-4 bg-warm-white">
  <div class="max-w-5xl mx-auto">
    <div class="reveal flex items-center gap-4 mb-8 sm:mb-14">
      <div class="w-1 h-8 bg-sage rounded-full shrink-0"></div>
      <h2 class="font-heading text-3xl sm:text-4xl font-semibold text-warm-gray">
        {frontmatter.title}
      </h2>
    </div>

    <div class="grid md:grid-cols-5 gap-8 md:gap-12 items-start">
      <!-- Photo: hidden on mobile to reduce scrolling -->
      <div class="reveal hidden md:flex md:col-span-2 justify-center">
        <div class="relative">
          <div class="absolute -inset-3 bg-sage/8 rounded-[1.5rem] -rotate-2" aria-hidden="true"></div>
          <img
            src={aboutImageSrc}
            alt={frontmatter.imageAlt as string}
            class="relative w-full max-w-sm rounded-2xl shadow-lg object-cover"
            loading="lazy"
          />
        </div>
      </div>

      <div class="reveal md:col-span-3">
        <div
          class="
            [&>p]:text-warm-gray-light [&>p]:leading-[1.8] [&>p]:mb-5 [&>p]:text-[0.95rem]
            [&>h2]:font-heading [&>h2]:text-xl [&>h2]:font-semibold [&>h2]:text-warm-gray [&>h2]:mt-8 [&>h2]:mb-4
            [&>ul]:text-warm-gray-light [&>ul]:space-y-2.5 [&>ul]:pl-0 [&>ul]:list-none
            [&>ul>li]:relative [&>ul>li]:pl-6
            [&>ul>li]:before:content-[''] [&>ul>li]:before:absolute [&>ul>li]:before:left-0 [&>ul>li]:before:top-[0.55em] [&>ul>li]:before:w-2 [&>ul>li]:before:h-2 [&>ul>li]:before:bg-sage/40 [&>ul>li]:before:rounded-full"
          set:html={html}
        />

        <div class="flex flex-wrap gap-3 mt-8 sm:mt-10 pt-6 sm:pt-8 border-t border-sage/15">
          {stats.map(({ icon, label }) => (
            <span class="inline-flex items-center gap-2.5 bg-sage/10 text-sage-dark text-sm font-medium px-5 py-2.5 rounded-full transition-all duration-200 hover:bg-sage/18">
              <span set:html={icon} />
              {label}
            </span>
          ))}
        </div>
      </div>
    </div>
  </div>
</section>
